<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/californiatemplate/template.xhtml">
    <ui:define name="content">


        <div class="card">

            <h:form id="departmentsView" enctype="multipart/form-data">
                <p:growl id="messages" showDetail="true" life="4000"/>

                <!-- 1. HEADER: Title with search options -->
                <div class="p-d-flex p-jc-between p-ai-start p-mb-4">
                    <div class="p-d-flex p-ai-center p-gap-2">
                        <p:commandButton icon="pi pi-arrow-left"
                                         styleClass="ui-button-text ui-button-outlined p-mr-3 "
                                         action="#{departmentTeamsView.cancel}"
                                         immediate="true"
                        />
                        <h2 style="margin: 0; color: #6c757d;">Department Members</h2>
                    </div>
                    <div>

                    </div>
                    <div>
                        <p:inputText id="searchTerm" required="false"
                                     value="#{departmentMembersView.searchTerm}"
                                     placeholder="Search department members"
                                     style="border-radius: 6px; padding: 10px 14px; font-size: 14px; min-width: 250px; border: 1px solid #ddd;">
                            <p:ajax event="keyup" listener="#{departmentMembersView.reloadFilterReset()}" />
                        </p:inputText>
                    </div>
                </div>

                <!-- 2. MEMBERS TABLE -->
                <div class="members-table-container">
                    <p:dataTable id="membersTable"
                                 value="#{departmentMembersView.departmentMembers}"
                                 var="member"
                                 styleClass="members-table"
                                 emptyMessage="No department members found"
                                 rows="10"
                                 paginator="true"
                                 paginatorPosition="bottom"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="10,25,50">

                        <!-- Name Column -->
                        <p:column headerText="Name" styleClass="name-column">
                            <h:outputText value="#{member.user.fullName}" />
                        </p:column>

                        <!-- Email Column -->
                        <p:column headerText="Email" styleClass="email-column">
                            <h:outputText value="#{member.user.emailAddress}" />
                        </p:column>

                        <!-- Role Column -->
                        <p:column headerText="Role" styleClass="role-column">
                            <h:outputText value="#{member.user.roles}" />
                        </p:column>

                        <!-- Action Column -->
                        <p:column headerText="Action" styleClass="action-column">
                            <p:commandButton title="Remove"
                                             styleClass="remove-button"
                                             icon="pi pi-trash"
                                             actionListener="#{departmentMembersView.deleteSelectedDepartment(member)}"
                                             update="membersTable departmentsView:messages"
                                             process="@this">
                                <p:confirm header="Confirmation"
                                           message="Are you sure you want to remove #{member.user.fullName}?"
                                           icon="pi pi-exclamation-triangle" />
                            </p:commandButton>
                        </p:column>

                    </p:dataTable>
                </div>

            </h:form>

        </div>


        <style>
            .card {
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                transition: box-shadow 0.3s ease;
                background: white;
                border-radius: 8px;
                overflow: hidden;
                padding: 20px;
            }

            .card:hover {
                box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            }

            /* Members Table Styling */
            .members-table-container {
                margin-top: 20px;
            }

            .members-table {
                width: 100%;
                border-collapse: collapse;
                background: white;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }

            .members-table .ui-datatable-header {
                background: #f8f9fa;
                border-bottom: 2px solid #e9ecef;
                font-weight: 600;
                color: #495057;
                padding: 12px 16px;
            }

            .members-table .ui-datatable-data tr {
                border-bottom: 1px solid #e9ecef;
                transition: background-color 0.2s ease;
            }

            .members-table .ui-datatable-data tr:hover {
                background-color: #f8f9fa;
            }

            .members-table .ui-datatable-data tr:last-child {
                border-bottom: none;
            }

            .members-table td {
                padding: 12px 16px;
                vertical-align: middle;
            }

            .members-table th {
                padding: 12px 16px;
                text-align: left;
                font-weight: 600;
                color: #495057;
                background: #f8f9fa;
                border-bottom: 2px solid #e9ecef;
            }

            /* Column specific styling */
            .name-column {
                min-width: 150px;
                font-weight: 500;
            }

            .email-column {
                min-width: 200px;
                color: #6c757d;
            }

            .role-column {
                min-width: 120px;
                color: #495057;
            }

            .action-column {
                width: 120px;
                text-align: center;
            }

            /* Remove button styling */
            .remove-button {
                border-radius: 4px;
                font-size: 12px;
                padding: 6px 12px;
                font-weight: 500;
                border: none;
                background-color: #dc3545;
                color: white;
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .remove-button:hover {
                background-color: #c82333;
                transform: translateY(-1px);
                box-shadow: 0 2px 4px rgba(220, 53, 69, 0.3);
            }

            .remove-button .pi-trash {
                margin-right: 4px;
            }

            /* General UI improvements */
            .ui-button {
                border-radius: 4px;
                font-weight: 500;
                text-transform: none;
            }

            .ui-inputtext {
                border-radius: 6px;
                border: 1px solid #ddd;
            }

            .ui-selectonemenu {
                border-radius: 4px;
            }

            .ui-button-text {
                background: none !important;
                border: none !important;
                padding: 4px !important;
            }

            .ui-button-text:hover {
                background-color: rgba(51, 122, 183, 0.1) !important;
            }

            /* Responsive design */
            @media (max-width: 768px) {
                .members-table td,
                .members-table th {
                    padding: 8px 12px;
                    font-size: 14px;
                }

                .email-column {
                    display: none;
                }

                .remove-button {
                    padding: 4px 8px;
                    font-size: 11px;
                }
            }

            /* Empty state styling */
            .ui-datatable-empty-message {
                text-align: center;
                padding: 40px 20px;
                color: #6c757d;
                font-style: italic;
            }

            /* Pagination styling */
            .ui-paginator {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-top: none;
                padding: 10px 15px;
                border-radius: 0 0 8px 8px;
            }
        </style>

    </ui:define>
</ui:composition>