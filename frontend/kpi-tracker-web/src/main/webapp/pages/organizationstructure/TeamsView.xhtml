<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/californiatemplate/template.xhtml">

    <ui:define name="content">
        <h:form id="teams" enctype="multipart/form-data">

            <!-- Header -->
            <div class="p-d-flex p-jc-between p-ai-center p-mb-4">
                <h2 class="p-text-secondary">Teams</h2>
                <p:commandButton value="Add Team"
                                 icon="pi pi-plus"
                                 actionListener="#{teamForm.show}"
                                 styleClass="add-button">
                    <f:setPropertyActionListener value="#{null}" target="#{teamForm.model}" />
                    <p:ajax event="dialogReturn" listener="#{teamsView.reloadFilterReset}" update="teamsGrid" />
                </p:commandButton>
            </div>

            <!-- Team Cards Grid -->
            <p:outputPanel id="teamsGrid" layout="block">
                <div class="p-grid p-nogutter">
                    <ui:repeat value="#{teamsView.dataModels}" var="team" varStatus="status">
                        <div class="p-col-12 p-md-6 p-lg-4 p-p-2">
                            <div class="card p-shadow-4 p-p-3"
                                 style="border-radius: 12px; background-color: #ffffff;">

                                <!-- Row 1: Team Name + Status -->
                                <div class="p-d-flex p-jc-between p-ai-start p-mb-2">
                                    <div>
                                        <h3 class="p-text-primary" style="margin:0;">#{team.teamName}</h3>
                                        <small class="p-text-secondary">#{team.teamDescription}</small>
                                    </div>
                                    <p:tag value="#{team.teamStatus}" severity="info" rounded="true"/>
                                </div>

                                <!-- Divider -->
                                <p:divider />

                                <!-- Row 2: Team Info (3 columns) -->
                                <div class="p-grid p-text-center">

                                    <!-- Team Head -->
                                    <div class="p-col-12 p-md-6 p-text-left p-p-2">
                                        <span class="p-text-secondary">Team Head</span>
                                        <h4 class="p-mt-1 p-text-primary">
                                            #{team.teamHead != null ? team.teamHead.fullName : '[Not assigned]'}
                                        </h4>
                                    </div>

                                    <!-- Members Count -->
                                    <div class="p-col-6 p-md-3 p-p-2">
                                        <span class="p-text-secondary">Members</span>
                                        <h4 class="p-mt-1 p-text-primary">0</h4>
                                    </div>

                                    <!-- Projects Count -->
                                    <div class="p-col-6 p-md-3 p-p-2">
                                        <span class="p-text-secondary">Projects</span>
                                        <h4 class="p-mt-1 p-text-primary">0</h4>
                                    </div>
                                </div>

                                <!-- Divider -->
                                <p:divider />

                                <!-- Row 3: Actions -->
                                <div class="p-d-flex p-jc-end p-ai-center p-flex-wrap" style="gap:10px;">
                                    <p:commandButton icon="pi pi-pencil" title="Edit"
                                                     styleClass="p-button-rounded p-button-text p-button-info"
                                                     actionListener="#{teamForm.show}">
                                        <f:setPropertyActionListener value="#{team}" target="#{teamForm.model}" />
                                        <p:ajax event="dialogReturn" update="teams" />
                                    </p:commandButton>

                                    <p:commandButton icon="pi pi-trash" title="Delete"
                                                     styleClass="p-button-rounded  ui-button-danger"
                                                     update="teams"
                                                     actionListener="#{teamsView.deleteClient(team)}">
                                        <p:confirm header="Delete Team"
                                                   message="Are you sure you want to delete '#{team.teamName}'?"
                                                   icon="pi pi-exclamation-triangle"/>
                                    </p:commandButton>
                                </div>

                            </div>
                        </div>
                    </ui:repeat>
                </div>
            </p:outputPanel>

            <!-- Global Confirm Dialog -->
            <p:confirmDialog global="true">
                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" />
                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no p-button-danger" />
            </p:confirmDialog>

        </h:form>
    </ui:define>
</ui:composition>
