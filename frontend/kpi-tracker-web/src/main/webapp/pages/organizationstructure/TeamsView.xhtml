<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/californiatemplate/template.xhtml">

    <ui:define name="content">
        <h:form id="teams" enctype="multipart/form-data">

            <!-- Header -->
            <div class="p-d-flex p-jc-between p-ai-center p-mb-4">
                <h2 style="margin: 0; color: #6c757d;">Teams</h2>
                <p:commandButton value="Add Team"
                                 actionListener="#{teamForm.show}"
                                 styleClass="p-button-success"
                                 style="padding: 0.5rem 1.5rem; font-weight: 600;">
                    <f:setPropertyActionListener value="#{null}" target="#{teamForm.model}" />
                    <p:ajax event="dialogReturn" listener="#{teamsView.reloadFilterReset}" update="teamsGrid" />
                </p:commandButton>
            </div>

            <!-- Team Cards Grid -->
            <p:outputPanel id="teamsGrid" layout="block">
                <div class="p-grid p-dir-col p-nogutter">
                    <ui:repeat value="#{teamsView.dataModels}" var="team" varStatus="status">
                        <div class="p-col-12 p-md-6 p-lg-4">
                            <div class="card p-p-3 p-mb-3" style="border: 1px solid #dee2e6; border-radius: 8px;">

                                <!-- Row 1: Team Name + Status -->
                                <div class="p-d-flex p-jc-between p-ai-start">
                                    <div style="flex:3;">
                                        <h3 style="margin:0; color:#0a9dff;">#{team.teamName}</h3>
                                        <h:outputText value="#{team.teamDescription}" style="color:#6c757d;" />
                                    </div>
                                    <div style="flex:1; text-align:right;">
                                        <p:tag value="#{team.teamStatus}" severity="info" rounded="true"/>
                                    </div>
                                </div>

                                <hr class="p-my-2"/>

                                <!-- Row 2: Team Info (3 columns) -->
                                <div class="p-d-flex p-jc-between p-ai-start">

                                    <!-- Column 1: Team Head (more space) -->
                                    <div style="flex:2; padding-right:20px;">
                                        <h:outputText value="Team Head" style="color: #6c757d;" />
                                        <h4 style="margin:0; color:#0a9dff;">
                                            #{team.teamHead != null ? team.teamHead.fullName : '[Not assigned]'}
                                        </h4>
                                    </div>

                                    <!-- Column 2: Members Count -->
                                    <div style="flex:1; text-align:center; border-left:1px solid #e0e0e0; padding-left:15px;">
                                        <h:outputText value="Members Count" style="color:#6c757d;" />
                                        <h4 style="margin:0; color:#0a9dff;">
                                           0
                                        </h4>
                                    </div>

                                    <!-- Column 3: Projects Count -->
                                    <div style="flex:1; text-align:center; border-left:1px solid #e0e0e0; padding-left:15px;">
                                        <h:outputText value="Projects Count" style="color:#6c757d;" />
                                        <h4 style="margin:0; color:#0a9dff;">
                                            0
                                        </h4>
                                    </div>
                                </div>

                                <hr class="p-my-2"/>

                                <!-- Row 3: Actions aligned to right -->
                                <div class="p-d-flex p-jc-end p-ai-center p-flex-wrap" style="gap:10px;">
                                    <p:commandButton icon="pi pi-pencil" title="Edit"
                                                     styleClass="p-button-rounded p-button-text p-mr-2"
                                                     actionListener="#{teamForm.show}">
                                        <f:setPropertyActionListener value="#{team}" target="#{teamForm.model}" />
                                        <p:ajax event="dialogReturn" update="teams" />
                                    </p:commandButton>

                                    <p:commandButton icon="pi pi-trash" title="Delete"
                                                     styleClass="p-button-rounded p-button-danger p-button-text"
                                                     update="teams"
                                                     actionListener="#{teamsView.deleteClient(team)}">
                                        <p:confirm header="Delete Team"
                                                   message="Are you sure you want to delete '#{team.teamName}'?"
                                                   icon="pi pi-exclamation-triangle"/>
                                    </p:commandButton>
                                </div>

                            </div>
                        </div>
                    </ui:repeat>
                </div>
            </p:outputPanel>

            <!-- Global Confirm Dialog -->
            <p:confirmDialog global="true">
                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" />
                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no p-button-danger" />
            </p:confirmDialog>

        </h:form>
    </ui:define>
</ui:composition>
