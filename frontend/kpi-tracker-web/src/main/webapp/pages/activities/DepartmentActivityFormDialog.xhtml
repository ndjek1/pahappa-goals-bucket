<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/californiatemplate/dialog-template.xhtml">

    <ui:define name="content">
        <title>Add Department Activity</title>

        <h:form id="departmentActivityForm" styleClass="card">
            <p:growl id="messages" showDetail="true" life="5000"/>

            <div class="p-grid ui-fluid" style="display: flex;">

                <!-- Title -->
                <div class="ui-col-12 ui-md-6">
                    <h5>Title</h5>
                    <div class="ui-inputgroup">
                        <p:inputText id="title"
                                     value="#{departmentActivityFormDialog.model.title}"
                                     required="true"
                                     requiredMessage="Title is required."
                                     placeholder="Enter activity title"
                                     styleClass="full-width"/>
                    </div>
                </div>

                <!-- Department Goal -->
                <div class="ui-col-12 ui-md-6">
                    <h5>Department Goal</h5>
                    <div class="ui-inputgroup">
                        <p:selectOneMenu id="deptGoal"
                                         value="#{departmentActivityFormDialog.selectedDepartmentGoal}"
                                         converter="departmentGoalConverter"
                                         filter="true"
                                         required="true"
                                         styleClass="full-width">
                            <f:selectItem itemLabel="Select department goal" itemValue=""/>
                            <f:selectItems value="#{departmentActivityFormDialog.departmentGoals}"
                                           var="goal"
                                           itemLabel="#{goal.name}"
                                           itemValue="#{goal}"/>
                        </p:selectOneMenu>
                    </div>
                </div>

                <!-- Activity Type -->
                <div class="ui-col-12 ui-md-6">
                    <h5>Activity Type</h5>
                    <div class="ui-inputgroup">
                        <p:selectOneMenu id="actType"
                                         value="#{departmentActivityFormDialog.selectedActivityType}"
                                         converter="activityTypeConverter"
                                         styleClass="full-width">
                            <f:selectItem itemLabel="Select activity type" itemValue=""/>
                            <f:selectItems value="#{departmentActivityFormDialog.activityTypes}"
                                           var="type"
                                           itemLabel="#{type.displayName}"
                                           itemValue="#{type}"/>
                            <p:ajax event="change" process="@this" update="departmentActivityForm:targetValuePanel"/>
                        </p:selectOneMenu>
                    </div>
                </div>
                <!-- Priority -->
                <div class="ui-col-12 ui-md-6">
                    <h5>Priority</h5>
                    <div class="ui-inputgroup">
                        <p:selectOneMenu id="priority"
                                         value="#{departmentActivityFormDialog.selectedPriority}"
                                         converter="activityPriorityConverter"
                                         styleClass="full-width">
                            <f:selectItem itemLabel="Select priority" itemValue=""/>
                            <f:selectItems value="#{departmentActivityFormDialog.priorities}"
                                           var="priority"
                                           itemLabel="#{priority.displayName}"
                                           itemValue="#{priority}"/>
                        </p:selectOneMenu>
                    </div>
                </div>



                <!-- Planned Start Date -->
                <div class="ui-col-12 ui-md-6">
                    <h5>Planned Start Date</h5>
                    <div class="ui-inputgroup">
                        <p:calendar id="startDate"
                                    value="#{departmentActivityFormDialog.model.plannedStartDate}"
                                    pattern="MM/dd/yyyy"
                                    showTime="false"
                                    styleClass="full-width"/>
                    </div>
                </div>

                <!-- Planned End Date -->
                <div class="ui-col-12 ui-md-6">
                    <h5>Planned End Date</h5>
                    <div class="ui-inputgroup">
                        <p:calendar id="endDate"
                                    value="#{departmentActivityFormDialog.model.plannedEndDate}"
                                    pattern="MM/dd/yyyy"
                                    showTime="false"
                                    styleClass="full-width"/>
                    </div>
                </div>

                <!-- Target Value (for quantitative) -->
                <h:panelGroup id="targetValuePanel" styleClass="ui-col-12 ui-md-12">
                    <h:panelGroup rendered="#{departmentActivityFormDialog.quantitativeSelected}">
                        <div class="ui-col-12">
                            <h5>Target Value</h5>
                            <div class="ui-inputgroup">
                                <p:inputNumber id="targetValue"
                                               value="#{departmentActivityFormDialog.model.targetValue}"
                                               decimalPlaces="0"
                                               minValue="0"
                                               required="#{departmentActivityFormDialog.quantitativeSelected}"
                                               requiredMessage="Target value is required for quantitative activities."
                                               placeholder="Enter target value"
                                               />
                            </div>
                            <p:message for="targetValue"/>
                        </div>
                    </h:panelGroup>
                </h:panelGroup>


                <!-- Description -->
                <div class="ui-col-12 ui-md-12">
                    <h5>Description</h5>
                    <div class="ui-inputgroup">
                        <p:inputTextarea id="desc"
                                         value="#{departmentActivityFormDialog.model.description}"
                                         rows="2"
                                         styleClass="full-width"/>
                    </div>
                </div>

            </div>

            <!-- Buttons Row -->
            <div class="ui-col-12 p-grid ui-fluid" style="display: flex; margin-top: 1em;">
                <div class="ui-col-12 ui-md-6">
                    <p:commandButton value="Cancel"
                                     immediate="true"
                                     action="#{departmentActivityFormDialog.hide}"
                                     styleClass="ui-button-danger full-width"/>
                </div>
                <div class="ui-col-12 ui-md-6">
                    <p:commandButton value="Save"
                                     process="@form"
                                     actionListener="#{departmentActivityFormDialog.persist}"
                                     update="@form "
                                     styleClass="ui-button-primary full-width">
                        <f:setPropertyActionListener value="#{true}" target="#{departmentActivitiesView.saved}"/>
                        <f:setPropertyActionListener value="#{false}" target="#{departmentActivitiesView.updated}"/>
                    </p:commandButton>
                </div>
            </div>

        </h:form>
    </ui:define>
</ui:composition>
