<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/californiatemplate/dialog-template.xhtml">

    <ui:define name="head">
        <style type="text/css">
            .capitalized {
                text-transform: capitalize;
            }
        </style>
    </ui:define>

    <ui:define name="content">
        <title>Add Department Activity</title>

        <h:form id="departmentActivityForm" styleClass="dialog-card">

            <p:growl id="growl" showDetail="true" life="4000"/>

            <div class="ui-fluid formgrid grid p-m-4">

                <!-- Title -->
                <div class="field col-12 md:col-4 p-m-4">
                    <p:outputLabel for="title" value="Title *"/>
                    <p:inputText id="title" value="#{departmentActivityFormDialog.model.title}"
                                 required="true"
                                 placeholder="Enter activity title"
                                 styleClass="p-inputtext-sm w-full"/>
                </div>

                <!-- Status -->
                <div class="field col-12 md:col-4 p-m-4">
                    <p:outputLabel for="status" value="Status"/>
                    <p:selectOneMenu id="status"
                                     value="#{departmentActivityFormDialog.selectedStatus}"
                                     converter="activityStatusConverter"
                                     filter="true" effect="fold"
                                     required="true"
                                     styleClass="w-full">
                        <f:selectItem itemLabel="Select status" itemValue=""/>
                        <f:selectItems value="#{departmentActivityFormDialog.activityStatuses}"
                                       var="status"
                                       itemLabel="#{status.displayName}"
                                       itemValue="#{status}"/>
                    </p:selectOneMenu>
                </div>

                <!-- Description -->
                <div class="field col-12 p-m-4">
                    <p:outputLabel for="desc" value="Description"/>
                    <p:inputTextarea id="desc"
                                     value="#{departmentActivityFormDialog.model.description}"
                                     rows="3"
                                     styleClass="w-full"/>
                </div>

                <!-- Department Goal -->
                <div class="field col-12 md:col-6 p-m-4">
                    <p:outputLabel for="deptGoal" value="Department Goal *"/>
                    <p:selectOneMenu id="deptGoal"
                                     value="#{departmentActivityFormDialog.selectedDepartmentGoal}"
                                     converter="departmentGoalConverter"
                                     filter="true" effect="fold"
                                     required="true"
                                     styleClass="w-full">
                        <f:selectItem itemLabel="Select department goal" itemValue=""/>
                        <f:selectItems value="#{departmentActivityFormDialog.departmentGoals}"
                                       var="goal"
                                       itemLabel="#{goal.name}"
                                       itemValue="#{goal}"/>
                    </p:selectOneMenu>
                </div>

                <!-- Activity Type -->
                <div class="field col-12 md:col-6 p-m-4">
                    <p:outputLabel for="actType" value="Activity Type"/>
                    <p:selectOneMenu id="actType"
                                     value="#{departmentActivityFormDialog.selectedActivityType}"
                                     converter="activityTypeConverter"
                                     effect="fold"
                                     styleClass="w-full">
                        <f:selectItem itemLabel="Select activity type" itemValue=""/>
                        <f:selectItems value="#{departmentActivityFormDialog.activityTypes}"
                                       var="type"
                                       itemLabel="#{type.displayName}"
                                       itemValue="#{type}"/>
                        <!-- Process this field and re-render the target panel -->
                        <p:ajax event="change"
                                process="@this"
                                update="departmentActivityForm:targetValuePanel"/>
                    </p:selectOneMenu>
                </div>

                <!-- Target Value (only for quantitative) -->
                <h:panelGroup id="targetValuePanel" layout="block">
                    <h:panelGroup rendered="#{departmentActivityFormDialog.quantitativeSelected}">
                        <div class="field col-12 md:col-6 p-m-4">
                            <p:outputLabel for="targetValue" value="Target Value"/>
                            <p:inputNumber id="targetValue"
                                           value="#{departmentActivityFormDialog.model.targetValue}"
                                           decimalPlaces="2"
                                           minValue="0"
                                           required="#{departmentActivityFormDialog.quantitativeSelected}"
                                           requiredMessage="Target value is required for quantitative activities."
                                           placeholder="Enter target value"
                                           styleClass="w-full"/>
                            <p:message for="targetValue"/>
                        </div>
                    </h:panelGroup>
                </h:panelGroup>


                <!-- Planned Start Date -->
                <div class="field col-12 md:col-4 p-m-4">
                    <p:outputLabel for="startDate" value="Planned Start Date"/>
                    <p:calendar id="startDate"
                                value="#{departmentActivityFormDialog.model.plannedStartDate}"
                                showTime="false"
                                pattern="MM/dd/yyyy"
                                styleClass="w-full"/>
                </div>

                <!-- Planned End Date -->
                <div class="field col-12 md:col-4 p-m-4">
                    <p:outputLabel for="endDate" value="Planned End Date"/>
                    <p:calendar id="endDate"
                                value="#{departmentActivityFormDialog.model.plannedEndDate}"
                                showTime="false"
                                pattern="MM/dd/yyyy"
                                styleClass="w-full"/>
                </div>

                <!-- Priority -->
                <div class="field col-12 md:col-4 p-m-4">
                    <p:outputLabel for="priority" value="Priority"/>
                    <p:selectOneMenu id="priority"
                                     value="#{departmentActivityFormDialog.selectedPriority}"
                                     converter="activityPriorityConverter"
                                     effect="fold"
                                     styleClass="w-full">
                        <f:selectItem itemLabel="Select priority" itemValue=""/>
                        <f:selectItems value="#{departmentActivityFormDialog.priorities}"
                                       var="priority"
                                       itemLabel="#{priority.displayName}"
                                       itemValue="#{priority}"/>
                    </p:selectOneMenu>
                </div>

                <!-- Buttons -->
                <div class="field col-12 p-d-flex p-jc-between p-mt-4">
                    <p:commandButton value="Cancel"
                                     process="@this"
                                     action="#{departmentActivityFormDialog.hide}"
                                     validateClient="false"
                                     styleClass="ui-button-outlined ui-button-help p-mx-5"/>

                    <p:commandButton value="Save"
                                     process="@form"
                                     actionListener="#{departmentActivityFormDialog.persist}"
                                     update="@form growl"
                                     validateClient="true"
                                     styleClass="ui-button-primary p-mx-5"/>
                </div>

            </div>
        </h:form>
    </ui:define>
</ui:composition>
