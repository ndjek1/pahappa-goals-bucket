<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                template="/pages/californiatemplate/template.xhtml">

    <ui:define name="head">
        <style>
            .capitalized { text-transform: capitalize; }
            .activity-nav-card {
                cursor: pointer;
                transition: all 0.3s ease;
                border: 1px solid #e0e0e0;
                padding: 2px;
                border-radius: 8px;
                background: #f9fafb;
            }
            .activity-nav-card:hover { transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
            .icon-circle { display:inline-flex; align-items:center; justify-content:center; width:20px; height:20px; border-radius:50%; color:#fff; font-size:10px; }
            .nav-card { background: #f9fafb; }
            .bg-green { background:#22c55e; } .bg-blue { background:#3b82f6; } .bg-purple { background:#8b5cf6; } .bg-orange { background:#f59e0b; } .bg-cyan { background:#06b6d4; }
            .nav-card h6 { margin:0; font-size:0.7rem; }
            .nav-card p { margin:0; font-size:0.64rem; color:#6b7280; }
            .stat-value { margin-left:auto; font-size:0.95rem; font-weight:600; }
            .text-primary { color:#3b82f6; } .text-success { color:#10b981; } .text-warning { color:#f59e0b; }
            .p-grid { margin:0 -0.2rem; } [class*='p-col-'] { padding:0 0.2rem; box-sizing: border-box; }
            .filter-input, .filter-select, .filter-calendar { width:100%; font-size:0.72rem; padding:0.16rem 0.28rem; border:1px solid #d1d5db; border-radius:0.3rem; }
            .breadcrumb-card { padding:3px 5px; margin:0 0 4px 0; }
            .breadcrumb-card .ui-breadcrumb { font-size:0.76rem; padding:0; margin:0; }
            .breadcrumb-card .ui-breadcrumb .ui-menuitem-link { padding:1px 5px; }
            .d-flex { display:flex; } .align-items-center { align-items:center; } .flex-grow-1 { flex-grow:1; } .me-3 { margin-right:0.35rem; }
            
            /* Custom button styles */
            .custom-btn {
                background: transparent !important;
                border: none !important;
                box-shadow: none !important;
                display: flex;
                align-items: center;
                padding: 6px 10px;
            }
            .custom-btn:hover {
                background: #b3d1e6 !important;
                border-radius: 8px;
            }
            .custom-icon {
                font-size: 1.2rem;
            }
            .custom-icon-edit {
                color: orange;
                font-size: 1.2rem;
            }
        </style>
    </ui:define>

    <ui:define name="content">
        <h:form id="individualGoalsView" enctype="multipart/form-data">
                        <p:growl id="messages" showDetail="true" />

            <!-- Breadcrumb Navigation -->
            <div class="card breadcrumb-card">
                <p:breadCrumb>
                    <p:menuitem value="Dashboard" icon="pi pi-home" outcome="/pages/dashboard/Dashboard" />
                    <p:menuitem value="Individual Goals" icon="pi pi-user" />
                </p:breadCrumb>
            </div>

            <!-- Statistics Cards -->
            <div class="card">
                <div class="p-grid" style="margin-top:-4px;">
                    <div class="p-col-12 p-md-3">
                        <div class="card activity-nav-card nav-card">
                            <div class="d-flex align-items-center">
                                <div class="icon-circle bg-blue me-3"><i class="pi pi-bullseye"></i></div>
                                <div class="flex-grow-1 d-flex align-items-center" style="gap:6px;">
                                    <h6 class="mb-0">Total Goals</h6>
                                    <span class="stat-value text-primary">#{individualGoalsView.dataModels.size()}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12 p-md-3">
                        <div class="card activity-nav-card nav-card">
                            <div class="d-flex align-items-center">
                                <div class="icon-circle bg-green me-3"><i class="pi pi-check-circle"></i></div>
                                <div class="flex-grow-1 d-flex align-items-center" style="gap:6px;">
                                    <h6 class="mb-0">Active Goals</h6>
                                    <span class="stat-value text-success">#{individualGoalsView.dataModels.stream().filter(g -> g.status == 'ACTIVE').count()}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12 p-md-3">
                        <div class="card activity-nav-card nav-card">
                            <div class="d-flex align-items-center">
                                <div class="icon-circle bg-warning me-3"><i class="pi pi-clock"></i></div>
                                <div class="flex-grow-1 d-flex align-items-center" style="gap:6px;">
                                    <h6 class="mb-0">Pending Goals</h6>
                                    <span class="stat-value text-warning">#{individualGoalsView.dataModels.stream().filter(g -> g.status == 'PENDING').count()}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-col-12 p-md-3">
                        <div class="card activity-nav-card nav-card">
                            <div class="d-flex align-items-center">
                                <div class="icon-circle bg-cyan me-3"><i class="pi pi-check"></i></div>
                                <div class="flex-grow-1 d-flex align-items-center" style="gap:6px;">
                                    <h6 class="mb-0">Completed Goals</h6>
                                    <span class="stat-value" style="color:#06b6d4">#{individualGoalsView.dataModels.stream().filter(g -> g.status == 'COMPLETED').count()}</span>
                                </div>
                            </div>
                            </div>
                    </div>
                </div>
            </div>

            <!-- Page Title and Add Button -->
            <div class="p-d-flex p-jc-between p-ai-center p-mb-3">
                <h2>My Goals</h2>
                <p:commandButton value="Set Goal" icon="pi pi-plus"
                                 styleClass="ui-button-success"
                                 actionListener="#{individualGoalForm.show}">
                    <f:setPropertyActionListener value="#{null}" target="#{individualGoalForm.model}"/>
                    <p:ajax event="dialogReturn" listener="#{individualGoalsView.reloadFilterReset}" update="individualGoalsView"/>
                </p:commandButton>
            </div>

            <!-- Filters -->
            <div class="p-d-flex p-ai-center p-mb-4">
                <p:commandButton value="All" styleClass="ui-button-primary p-mr-2" />
                <p:selectOneMenu value="..." style="margin-right:1rem;">
                    <f:selectItem itemLabel="Level" itemValue=""/>
                    <f:selectItems value="..."/>
                </p:selectOneMenu>
                <p:selectOneMenu value="..." style="margin-right:1rem;">
                    <f:selectItem itemLabel="Status" itemValue=""/>
                    <f:selectItems value="..."/>
                </p:selectOneMenu>
                <p:inputText placeholder="Search Goal" label="Search goal..." style="flex:1"/>
            </div>

            <!-- Goal Cards -->
            <div class="p-grid p-nogutter p-mt-2" style="background: white">
            <ui:repeat value="#{individualGoalsView.dataModels}" var="goal">
                <div class="p-col-12 p-md-6 p-p-2">
                <div class="p-card p-p-3 p-mb-3 "
                     style="border: 1px solid #dee2e6; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">

                    <!-- Goal Title -->
                    <h4 style="margin: 0; margin-bottom: 0.8rem; font-weight: 600;">
                        #{goal.name}
                    </h4>

                    <!-- Horizontal Divider -->
                    <hr style="border: 0; border-top: 1px solid #ccc; margin: 0.5rem 0 1rem 0;" />
                    
                    <!-- Details Row -->
                    <div class="p-d-flex p-flex-wrap p-mb-2" style="font-size: 0.9rem; color: #444;">

                        <div class="p-d-flex p-flex-column p-ai-center p-pr-3 "
                             style="border-right: 1px solid #ccc; margin-right: 1rem;">
                            <span style="font-weight: 600;">Weight</span>
                            <span style="color: #2155A3 ; margin: 5px" >#{goal.contributionWeight}%</span>
                        </div>

                        <div class="p-d-flex p-flex-column p-ai-center p-pr-3 p-mx-3"
                             style="border-right: 1px solid #ccc; margin-right: 1rem;">
                            <span style="font-weight: 600;">Status</span>
                            <span style="color: #2155A3 ; margin: 5px"  >#{goal.status}</span>
                        </div>

                        <div class="p-d-flex p-flex-column p-ai-center p-pr-3 p-mx-3">
                            <span style="font-weight: 600;">Description</span>
                            <span style="color: #2155A3 ; margin: 5px"  >#{goal.description}</span>
                                    </div>

                                </div>

                    <!-- Action Buttons -->
                    <div class="p-d-flex p-jc-end p-mt-3">
                                <p:commandButton icon="fa fa-edit" title="Edit"
                                         styleClass="custom-btn"
                                                 actionListener="#{individualGoalForm.show}">
                            <f:setPropertyActionListener value="#{goal}" target="#{individualGoalForm.model}" />
                            <p:ajax event="dialogReturn" update="individualGoalsView" />
                                </p:commandButton>
                                <p:commandButton icon="fa fa-trash" title="Delete"
                                         styleClass="custom-btn"
                                         actionListener="#{individualGoalsView.deleteClient(goal)}">
                                    <p:confirm header="Confirmation"
                                       message="Are you sure you want to delete this goal?"
                                               icon="fa fa-question-circle" />
                            <p:ajax event="dialogReturn" update="individualGoalsView" />
                                </p:commandButton>
                    </div>
                </div>
                </div>
            </ui:repeat>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
